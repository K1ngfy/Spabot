// quotes_db.js - The Wisdom Dictionary for Spabot

(function(global) {
  global.QUOTES_DB = {
    // ==========================================
    // 1. 场景化精选金句 (Static Quality Quotes)
    // ==========================================
    
    // [新增] SPL 性能优化小贴士 (Optimization Tips)
    optimization_tips: [
        "小贴士：尽早过滤！把 `search` 命令放在管道的最左边，减少后续处理的数据量。",
        "小贴士：尽量别用 `transaction`，它非常消耗内存。试试用 `stats` 配合 `values()` 替代，速度通常快 10 倍。",
        "小贴士：只需要几个特定字段？请使用 `fields + 字段名`，别让 Splunk 搬运一堆你不需要的数据。",
        "小贴士：避免使用前缀通配符（如 `*fail`），这会导致索引扫描失效，变成全表硬扫。",
        "小贴士：如果只是想看趋势图，试试 `tstats` 命令，它直接从索引头读取数据，比 `stats` 快得飞起。",
        "小贴士：在 `join` 之前，务必先在子搜索里过滤数据。更好的选择是：尽量用 `stats` 或 `lookup` 代替 `join`。",
        "小贴士：不要滥用 `dedup`，它很吃内存。如果你只是想要最新的一条记录，试试 `stats latest(_time) by host`。",
        "小贴士：使用 `TERM()` 可以强制 Splunk 匹配完整词汇，避开分词器的干扰，搜索特定 IP 或 ID 时很有用。",
        "小贴士：`eval` 命令很强大，但请把它放在 `search` 过滤之后。先筛选数据，再进行计算。",
        "小贴士：永远明确指定 `index` 和 `sourcetype`。这是告诉 Splunk 去哪里找数据的最快方式。",
        "小贴士：如果数据量巨大，考虑使用 Report Acceleration (报表加速) 或 Summary Indexing (摘要索引)。",
        "小贴士：不要在生产环境高峰期跑实时搜索 (Real-time Search)，你的管理员会感谢你的。",
            // --- 性能优化篇 (Performance) ---
        "性能贴士：`tstats` 是速度之王。只要是 indexed field（如 host, source, sourcetype），用 tstats 提速通常是 100 倍起步。",
        "性能贴士：在子搜索中，尽量使用 `earliest` 和 `latest` 限定时间范围，避免子搜索扫描过多数据拖累主搜索。",
        "性能贴士：不要用 `join`，除非万不得已。90% 的 join 场景都可以用 `stats values() by CommonField` 或 `lookup` 替代。",
        "性能贴士：`fields - _raw` 是个好习惯。如果你不需要看原始日志，只看表格，扔掉 `_raw` 可以极大节省内存。",
        "性能贴士：使用 `TERM(ip_address)` 而不是直接搜 IP，可以强制 Splunk 跳过分词器直接匹配完整词，搜索 IP 地址的神器。",
        "性能贴士：`bin _time span=1h` 比 `bucket _time` 写法更现代，效果一样，但配合 stats 使用更顺手。",
        "性能贴士：尽量避免在 `search` 命令中使用 `NOT field=value`，这通常比 `field!=value` 更慢，因为 NOT 经常导致全表扫描。",
        "性能贴士：如果在做大量的 `regex` 提取，考虑在 props.conf 里做字段提取（Field Extraction），而不是每次都在 SPL 里写 `rex`。",
        "性能贴士：`dedup` 命令很方便，但它会消耗大量内存来维持状态。如果只需要去重计数，请用 `stats dc(field)`。",
        "性能贴士：如果你在用 `transaction` 只是为了把相关日志组合在一起，试试 `stats values(*) as * by transaction_id`，性能会好很多。",

        // --- 数据清洗与处理篇 (Data Munging) ---
        "小技巧：`coalesce(field1, field2, \"default\")` 是处理 NULL 值的神器。它会取第一个非空值，非常适合合并多个相似字段。",
        "小技巧：需要脱敏数据？使用 `| rex mode=sed \"s/(\\d{3})\\d{4}(\\d{4})/\\1****\\2/\"` 可以把手机号中间四位变成星号。",
        "小技巧：`fillnull value=0` 在做数学计算前非常重要，否则空值会导致 `eval` 计算结果也为空。",
        "小技巧：使用 `foreach` 命令可以批量处理字段。例如 `foreach user_* [eval <<FIELD>> = upper(<<FIELD>>)]` 把所有 user_ 开头的字段转大写。",
        "小技巧：`makemv delim=\",\" my_field` 可以把逗号分隔的字符串瞬间变成多值字段（Array）。",
        "小技巧：`mvexpand` 可以把多值字段拆分成多行事件（Rows），方便后续统计，但要注意它会增加事件数量。",
        "小技巧：`spath` 命令解析 JSON 数据比 `rex` 强一万倍。如果日志是 JSON 格式，直接 `| spath` 自动提取所有字段。",
        "小技巧：`extract pairdelim=\",\" kvdelim=\":\"` 可以快速解析 key:value 格式的非标准日志。",
        "小技巧：想过滤多值字段中的某一个值？`| where match(my_mv_field, \"pattern\")` 了解一下。",
        "小技巧：`trim(field)` 只能去除首尾空格？试试 `replace(field, \"\\s+\", \"\")` 去除所有空格。",

        // --- 统计与分析篇 (Stats & Analysis) ---
        "统计技巧：`eventstats` 是个黑魔法。它能计算统计值（如平均值）并把结果写回每一条原始日志里，让你既能看明细，又能做对比（例如：当前值 vs 平均值）。",
        "统计技巧：`streamstats` 可以做“滑动窗口”计算。例如计算“最近 5 分钟的移动平均值”或“累计求和”。",
        "统计技巧：想看某个字段最罕见的值？使用 `rare` 命令，它就是 `top` 命令的反义词。",
        "统计技巧：`top limit=0` 会显示所有值的排名，而不是默认的前 10 个。",
        "统计技巧：使用 `stats count by date_hour` 可以快速生成热力图数据，分析哪个时间段业务最忙。",
        "统计技巧：`geostats` 配合 `iplocation` 可以直接在地图上画出攻击来源分布。",
        "统计技巧：`addtotals` 可以快速计算一行中多个数值字段的总和，不用写一大串 `eval sum=a+b+c...`。",
        "统计技巧：`chart count over host by status` 是生成堆叠柱状图的标准姿势。",
        "统计技巧：`contingency` (或 `associate`) 命令可以帮你发现两个字段之间的关联性（卡方检验）。",
        "统计技巧：在 `stats` 之后使用 `xyseries` 可以把长表（Long format）转换成宽表（Wide format），类似 Excel 的透视表。",

        // --- 时间处理篇 (Time Mastery) ---
        "时间技巧：`eval time_diff = now() - _time` 可以计算日志生成时间和当前的延迟。",
        "时间技巧：`strftime(_time, \"%F %T\")` 是最标准的可读时间格式转换。",
        "时间技巧：想搜索“上周一”的数据？`earliest=-1w@w1 latest=@w2`，Splunk 的相对时间语法非常强大。",
        "时间技巧：`gentimes start=-1` 可以生成一个虚拟的时间表，用于填充那些“没有日志”的时间段，做零值补全。",
        "时间技巧：`relative_time(now(), \"-1d@d\")` 可以用来在 eval 中计算昨天的零点时间戳。",
        "时间技巧：不要在 eval 里手动解析时间字符串，使用 `strptime` 函数更安全。",

        // --- 安全与网络篇 (Security & Network) ---
        "安全技巧：`cidrmatch(\"192.168.0.0/16\", ip)` 可以判断 IP 是否在某个网段内，防火墙分析必备。",
        "安全技巧：`lookup dnslookup clientip as src_ip OUTPUT clienthost` 可以反查 IP 的域名。",
        "安全技巧：使用 `iplocation` 时，记得它不仅有 Country，还有 City, Lat, Lon 等信息。",
        "安全技巧：检测暴力破解？`| streamstats window=5 count(eval(action=\"failure\")) as failures by src_ip | where failures > 10`。",
        "安全技巧：`urldecode(url_field)` 可以还原被编码的恶意 URL 载荷。",

        // --- 调试与黑科技 (Hacks & Debugging) ---
        "调试技巧：`| makeresults count=1` 可以生成一个虚拟事件，专门用来测试 `eval` 逻辑或生成测试数据。",
        "调试技巧：`format` 命令通常用在子搜索的最后，它可以把子搜索的结果格式化为 OR 连接的查询字符串。",
        "调试技巧：`metadata type=hosts index=*` 是查看所有主机最近一次上报时间的最快方法（比搜索日志快得多）。",
        "调试技巧：在搜索 URL 后面加上 `&output_mode=json` 可以直接通过浏览器 API 获取 JSON 结果。",
        "调试技巧：`dbinspect index=main` 可以查看 bucket 级别的存储详情，用于排查存储占用问题。",
        "调试技巧：使用 `append` 会增加搜索开销，尽量用 `multisearch` 来并行搜索多个不相关的索引。",
        "调试技巧：`map` 命令很强大（类似编程里的 for 循环），但性能极差，能不用就不用。",
        "调试技巧：`fieldsummary` 命令可以快速对所有字段进行概览（覆盖率、最大值、最小值、唯一值数量）。",
        "调试技巧：忘记宏里写了什么？使用 `| splunk show macro 宏名称`（需要权限）或者直接在 Spabot 里查看。",
        "调试技巧：使用 `return` 命令在子搜索中只返回你需要的字段值，保持主搜索整洁。"
    ],

    // 当检测到 SPL 包含 'index=*' 或全表扫描时
    danger_zone: [
        "写 index=* 的人，上辈子都是折翼的天使。",
        "你的搜索范围这么大，是想把公司的电表转速拉满吗？",
        "服务器正在报警，因为它感觉到了你要做全量搜索。",
        "License 余额不足，请珍惜每一个字节。",
        "如果你不加 sourcetype，神仙也救不了这个查询速度。",
        "正在尝试检索全宇宙的数据... 可能会耗时一万年。",
        "勇士，你这是在对 Splunk 进行压力测试吗？",
        "运维大哥提着刀正在赶来的路上 (原因: index=*)。",
        "为了地球环保，请缩小一下 timeframe 吧。",
        "你并没有在这个 index 里，对吧？",
        "警告：此操作可能导致搜索头（Search Head）秃头。",
        "全表扫描一时爽，一直扫描一直... 宕机。"
    ],

    // 当搜索耗时过长（Waiting）
    waiting: [
        "正在和数据源进行量子纠缠...",
        "别急，数据正在从火星传回来。",
        "你可以趁现在去接杯咖啡，或者写个辞职信（划掉）。",
        "Loading... 进度 99% (卡住是常态)。",
        "正在从 /dev/null 捞数据，这可能需要一点时间。",
        "因为你的查询太复杂，CPU 决定先抽根烟。",
        "Splunk 正在思考人生，请勿打扰。",
        "这速度，我奶奶用算盘都比它快。",
        "正在遍历 10 亿条日志，少一条都不行。",
        "您可以深呼吸，做个冥想。",
        "CPU: 我太难了。",
        "内存已离家出走。",
        "正在解压 gzip，甚至可能还要解压 zip，谁知道呢。",
        "这查询跑得比周五下午的时间还慢。"
    ],

    // 安全运营/SOC 专属梗 (SecOps)
    secops: [
        "只要我不看 Log，就没有 Incident。",
        "这个 IP 看起来人畜无害，直到你把它放进微步在线。",
        "误报（False Positive）是检验真理的唯一标准。",
        "黑客正在休息，你也可以休息一下。",
        "你确定这是 APT 攻击？我看像管理员手滑。",
        "正在分析流量... 全是 404，这波稳了。",
        "Base64 解码出来了吗？希望不是 'Hello World'。",
        "红队（Red Team）进来了吗？还没？那继续睡。",
        "世界上只有两种公司：被黑过的，和不知道自己被黑过的。",
        "Root 权限是万恶之源。",
        "不要相信任何 User-Agent，它们都在撒谎。",
        "那个 PowerShell 脚本看起来好像经过了五层混淆。",
        "防火墙说：这个包我不背。",
        "SIEM 告警 99+，实际威胁 0。",
        "正在把锅甩给网络组...",
        "WAF 已经尽力了，剩下的交给你了。",
        "你看这个 Hash，它又长又宽。",
        "不要随便点邮件里的链接，哪怕是老板发的（特别是老板发的）。"
    ],

    // 运维/打工人通用梗 (DevOps/Life)
    life: [
        "代码和你，总有一个能跑就行。",
        "重启能解决 90% 的问题，剩下的 10% 需要重装。",
        "今天是周五，千万不要发布上线！重复，不要上线！",
        "咖啡因摄入量不足，系统即将休眠。",
        "根据我的计算，距离下班还有 [TIME_LEFT]。", 
        "这个 Bug 不是 Bug，是 Feature。",
        "我在 Log 里看到了你的泪水。",
        "键盘敲烂，月薪过万。",
        "人生就像 SPL，充满了管道符（坎坷）。",
        "不要和产品经理吵架，会掉发。",
        "服务器活着，你活着，这美好的一天。",
        "记得提交代码，不然停电就神作了。",
        "404 Not Found: 你的假期未找到。",
        "500 Internal Server Error: 你的脑子。",
        "Ctrl+C 和 Ctrl+V 是人类最伟大的发明。",
        "正在把需求文档丢进碎纸机。",
        "老板正在看着你，假装在敲键盘！快！",
        "在这个复杂的网络世界里，你是最后一道防线。",
        "记得喝水，肾结石很疼的。",
        "坐直了！你的腰间盘在尖叫。",
        "眼睛离屏幕远点，虽然我知道你看不清。",
        "每按一次回车，就有一行代码被执行（废话）。"
    ],

    // 股市吐槽/韭菜语录 (Stock Market/Leek)
    stock_market: [
        "本来想赚个买菜钱，结果把菜市场赔进去了。",
        "我的持仓红得像过年，可惜是绿色的那个红（美股反着看）。",
        "主力在出货，散户在接盘，我在中间当气氛组。",
        "抄底抄在了半山腰，现在山顶风好大。",
        "K线图画得比梵高还抽象，完全看不懂。",
        "今天大盘跳水，我也想跳了（开玩笑的）。",
        "只要我不卖，就不算亏——来自资深韭菜的自我修养。",
        "不仅要防黑客，还要防庄家，这日子没法过了。",
        "Splunk 索引速度再快，也没这垃圾大A跌的快，555~",
        "正在计算回本还需要几个涨停板... Error: Integer Overflow.",
        "今天吃面还是吃肉啊?",
        "不仅被 Log 淹没，还被被套牢，人生太难了。",
        "今天加仓了吗？加了，加在最高点。",
        "所谓的价值投资，就是被套牢后找的借口。",
        "一顿操作猛如虎，一看账户二百五。",
        "技术面分析：MACD 死叉；基本面分析：关灯吃面。",
        "我的自选股全是绿的，Splunk 仪表盘都没这么绿。",
        "如果把炒股的劲头拿来写 SPL，我早就是 Splunk 专家了。",
        "不仅要监控服务器，还要监控我的股票（心跳加速）。",
        "天台风很大，大家排好队，不要挤。"
    ],

    // ==========================================
    // 2. 模板生成器词库 (Template Generator)
    // 用于组合生成无限废话
    // ==========================================
    
    templates: {
        subjects: [
            "服务器", "防火墙", "数据库", "那个实习生", "老板", "网络组",
            "你的代码", "这个查询", "DNS", "K8s集群", "Python脚本", "Splunk Indexer",
            "隔壁老王", "黑客", "AI模型", "搜索头", "许可证服务器"
        ],
        verbs: [
            "炸了", "正在哭泣", "离家出走了", "拒绝工作", "正在摸鱼",
            "决定自我毁灭", "正在挖矿", "被外星人劫持了", "穿越回了1999年",
            "正在通过图灵测试", "申请了年假", "过热了", "内存溢出了",
            "陷入了死循环", "开始怀疑人生"
        ],
        reasons: [
            "因为你没写注释", "因为今天是周一", "因为水逆", "因为没有咖啡",
            "因为 index=*", "因为正则表达式写错了", "因为没加 sourcetype",
            "因为磁盘满了", "因为有人碰了网线", "因为爱",
            "为了维护世界和平", "只是为了引起你的注意", "因为它是处女座"
        ]
    }
  };
})(window);
